<odoo>
    <data>
        <template id="owner_stock" name="Stock Management">
            <t t-call="pharmacy.owner_layout">
                <h1 class="text-3xl font-bold text-green-700 mb-6">Stock Management</h1>
                <p class="text-gray-700 mb-4">Manage stock for your pharmacy below.</p>

                <form action="/owner/manage_stock" method="post" class="mb-10 max-w-full mx-auto bg-white p-6 rounded shadow-md flex items-center space-x-4">
                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                    <input type="hidden" name="stock_id" t-att-value="form_data.get('stock_id') if form_data else ''" />

                    <div class="relative z-0 flex-1">
                        <label for="medicine_id" class="block text-sm font-medium text-gray-700 mb-2">Medicine</label>
                       <select name="medicine_id" id="medicine_id" class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-green-600 appearance-none focus:outline-none focus:ring-0 focus:border-green-600 peer" required="required">
                            <option value="">Select a Medicine</option>
                            <t t-foreach="medicines" t-as="medicine">
                                <option t-att-value="medicine.id" t-att-selected="'selected' if form_data and form_data.get('medicine_id') == medicine.id else ''" t-esc="medicine.name" />
                            </t>
                        </select>
                    </div>


                    <div class="relative z-0 flex-1">
                            <label for="price" class="block text-sm font-medium text-gray-700 mb-2">Price</label>
                            <input type="number" name="price" id="price" class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-green-600 appearance-none focus:outline-none focus:ring-0 focus:border-green-600 peer" t-att-value="form_data.get('price') if form_data else ''" min="0.01" step="0.01" required="required" />
                    </div>
                    <div class="relative z-0 flex-1">
                            <label for="quantity" class="block text-sm font-medium text-gray-700 mb-2">Quantity</label>
                            <input type="number" name="quantity" id="quantity" class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-green-600 appearance-none focus:outline-none focus:ring-0 focus:border-green-600 peer" t-att-value="form_data.get('quantity') if form_data else ''" min="1" required="required" />
                    </div>


                    <button type="submit" class="text-white bg-green-600 hover:bg-green-700 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center">
                        Save Stock
                    </button>
                </form>


                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl text-gray-700">Existing Stocks</h2>

                    <!-- Search Bar -->
                    <div class="flex px-4 py-3 rounded-md border-2 border-green-500 overflow-hidden max-w-md ml-auto font-[sans-serif]">
                        <input id="search-bar" type="email" placeholder="Search Something..." class="w-full outline-none bg-transparent text-gray-600 text-sm" />
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192.904 192.904" width="16px" class="fill-gray-600">
                            <path
                                d="m190.707 180.101-47.078-47.077c11.702-14.072 18.752-32.142 18.752-51.831C162.381 36.423 125.959 0 81.191 0 36.422 0 0 36.423 0 81.193c0 44.767 36.422 81.187 81.191 81.187 19.688 0 37.759-7.049 51.831-18.751l47.079 47.078a7.474 7.474 0 0 0 5.303 2.197 7.498 7.498 0 0 0 5.303-12.803zM15 81.193C15 44.694 44.693 15 81.191 15c36.497 0 66.189 29.694 66.189 66.193 0 36.496-29.692 66.187-66.189 66.187C44.693 147.38 15 117.689 15 81.193z">
                            </path>
                        </svg>
                    </div>
                </div>

                <div class="mt-7 overflow-x-auto">
                    <table class="w-full whitespace-nowrap">
                        <thead class="bg-green-600 text-white">
                           <tr>
                              <th class="px-4 py-3 text-left w-2/6">Medicine</th>
                              <th class="px-4 py-3 text-left w-1/6">Price</th>
                              <th class="px-4 py-3 text-left w-1/6">Quantity</th>
                              <th class="px-4 py-3 text-left w-2/6">Actions</th>
                           </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="stocks" t-as="stock">
                                 <tr class="h-1"></tr>
                                 <tr class="focus:outline-none h-16 border border-gray-100 rounded">
                                     <td>
                                        <div class="flex items-center pl-5">
                                           <p class="text-sm leading-none text-gray-600"
                                              t-esc="stock.medicine_id.name"></p>
                                        </div>
                                     </td>
                                     <td>
                                        <div class="flex items-center pl-5">
                                           <p class="text-sm leading-none text-gray-600"
                                              t-esc="stock.price"></p>
                                        </div>
                                     </td>
                                     <td>
                                        <div class="flex items-center pl-5">
                                           <p class="text-sm leading-none text-gray-600"
                                              t-esc="stock.quantity"></p>
                                        </div>
                                     </td>
                                     <td>
                                          <div class="flex items-center space-x-4 px-5 py-2">
                                            <!-- Edit Button -->
                                            <form action="/owner/manage_stock" method="get" class="inline-block">
                                              <input type="hidden" name="stock_id" t-att-value="stock.id" />
                                              <button type="submit" class="text-gray-900 bg-white border border-gray-300 focus:outline-none
                                              hover:bg-gray-100 focus:ring-4 focus:ring-gray-100 font-medium rounded-lg text-sm px-4 py-2
                                              dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700">
                                                Edit
                                              </button>
                                            </form>

                                            <!-- Delete Button -->
                                            <form action="/owner/delete_stock" method="post" class="inline-block">
                                              <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                                              <input type="hidden" name="stock_id" t-att-value="stock.id" />
                                              <button type="submit" class="text-gray-900 bg-white border border-gray-300 focus:outline-none
                                              hover:bg-gray-100 focus:ring-4 focus:ring-gray-100 font-medium rounded-lg text-sm px-4 py-2
                                              dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700">
                                                Delete
                                              </button>
                                            </form>
                                          </div>
                                     </td>
                                 </tr>
                            </t>
                            <t t-if="not stocks">
                              <tr class="h-1"></tr>
                              <tr>
                                <td colspan="7" class="text-center text-sm leading-none text-gray-600 py-2">
                                   No stocks available.
                                </td>
                              </tr>
                            </t>
                        </tbody>
                    </table>
                </div>

                 <script>
                     document.getElementById('search-bar').addEventListener('input', function () {
                          const query = this.value.toLowerCase();
                          document.querySelectorAll('tbody tr').forEach(row => {
                            const rowText = row.textContent.toLowerCase();
                            row.style.display = rowText.includes(query) ? '' : 'none';
                          });
                        });
                 </script>
            </t>
        </template>
    </data>
</odoo>
